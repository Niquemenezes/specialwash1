services:
  - type: web
    name: specialwash1
    env: python
    plan: free
    branch: main
    autoDeploy: true

    buildCommand: |
      pip install -r requirements.txt

    startCommand: >
      gunicorn -w 4 -k gthread -b 0.0.0.0:$PORT src.app:app

    # Corre migraciones ANTES de publicar cada deploy
    preDeployCommand: |
      flask db upgrade

    envVars:
      - key: PYTHON_VERSION
        value: 3.11.8
      - key: FLASK_ENV
        value: production
      # Define el resto (JWT_SECRET_KEY, DATABASE_URL, etc.) desde el panel
